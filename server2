import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.net.ServerSocket;
import java.net.Socket;

class ConnectionThread extends Thread{
	private Socket sock;
	private DataInputStream dis;
	private DataOutputStream dos;
	
	private int fileNumber;
	private String[] fileList = new String[fileNumber];
	
	public ConnectionThread(Socket sock) {
		try {
		this.sock = sock;
		this.dos = new DataOutputStream(sock.getOutputStream());
		}catch (Exception e) {
			e.printStackTrace();
		}
	}

	
	public void run() {
		
		System.out.println(sock.getInetAddress()+" on");
		File f = new File("D:/vvvvv/success1.txt");
		long filesize = f.length();
		
		try {
			FileInputStream fis = new FileInputStream(f);
			DataInputStream dis = new DataInputStream(fis);
			
			byte[] fileContents = new byte[(int)filesize];
			
			dis.readFully(fileContents);
			this.dos.writeInt((int)filesize);
			this.dos.write(fileContents);
			this.dos.flush();
			
		}catch(Exception e) {
			System.out.println("no file");
			e.printStackTrace();
		}
	}
	
}

public class Server2{
	public static void main(String[] args)throws Exception{
		ServerSocket server = new ServerSocket(40000);
		
		while(true) {
			Socket sock = server.accept();
			new ConnectionThread(sock).start();
		}
		
		
	}
}

